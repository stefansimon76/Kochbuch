<!DOCTYPE html>
<html lang="de-DE">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" href="http://retro-planer.de/kochbuch/images/favicon.png" type = "image/png">
    <link rel="stylesheet" href="/@kochbuch.css">
    <link rel="stylesheet" href="/extern/bootstrap-4.5.3-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/extern/bootstrap-fileinput/css/fileinput.min.css" media="all" type="text/css" />
    <link rel="stylesheet" href="/extern/fontawesome/css/all.min.css">
    <script src="/extern/jquery-3.5.1.min.js"></script>
<!--    <script src="/extern/bootstrap-fileinput/js/plugins/piexif.min.js" type="text/javascript"></script>-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.9/js/plugins/sortable.min.js" type="text/javascript"></script>-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>-->
<!--    <script src="/extern/bootstrap-4.5.3-dist/js/bootstrap.bundle.min.js"></script>-->
    <script src="/extern/bootstrap-fileinput/js/fileinput.min.js"></script>
    <script src="/extern/bootstrap-fileinput/themes/fas/theme.min.js"></script>
    <script src="/extern/bootstrap-fileinput/js/locales/de.js"></script>

<!--    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" crossorigin="anonymous">-->
<!--    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.9/css/fileinput.min.css" media="all" rel="stylesheet" type="text/css" />-->
    <!-- if using RTL (Right-To-Left) orientation, load the RTL CSS file after fileinput.css by uncommenting below -->
    <!-- link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.9/css/fileinput-rtl.min.css" media="all" rel="stylesheet" type="text/css" /-->
    <!-- the font awesome icon library if using with `fas` theme (or Bootstrap 4.x). Note that default icons used in the plugin are glyphicons that are bundled only with Bootstrap 3.x. -->
<!--    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" crossorigin="anonymous">-->
<!--    <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>-->
<!--    &lt;!&ndash; piexif.min.js is needed for auto orienting image files OR when restoring exif data in resized images and when you-->
<!--        wish to resize images before upload. This must be loaded before fileinput.min.js &ndash;&gt;-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.9/js/plugins/piexif.min.js" type="text/javascript"></script>-->
<!--    &lt;!&ndash; sortable.min.js is only needed if you wish to sort / rearrange files in initial preview.-->
<!--        This must be loaded before fileinput.min.js &ndash;&gt;-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.9/js/plugins/sortable.min.js" type="text/javascript"></script>-->
<!--    &lt;!&ndash; popper.min.js below is needed if you use bootstrap 4.x (for popover and tooltips). You can also use the bootstrap js-->
<!--       3.3.x versions without popper.min.js. &ndash;&gt;-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>-->
<!--    &lt;!&ndash; bootstrap.min.js below is needed if you wish to zoom and preview file content in a detail modal-->
<!--        dialog. bootstrap 4.x is supported. You can also use the bootstrap js 3.3.x versions. &ndash;&gt;-->
<!--    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>-->
<!--    &lt;!&ndash; the main fileinput plugin file &ndash;&gt;-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.9/js/fileinput.min.js"></script>-->
<!--    &lt;!&ndash; following theme script is needed to use the Font Awesome 5.x theme (`fas`) &ndash;&gt;-->
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.9/themes/fas/theme.min.js"></script>-->
<!--    &lt;!&ndash; optionally if you need translation for your language then include the locale file as mentioned below (replace LANG.js with your language locale) &ndash;&gt;-->
<!--    <script src="/extern/bootstrap-fileinput/js/locales/de.js"></script>-->
    <title>Kochbuch</title>
</head>
<body>
{{#_SESSION.showCookiePopup}}
    {{>cookie}} {{! ggf. Hinweis auf die Verwendung von Cookies anzeigen }}
{{/_SESSION.showCookiePopup}}

<div class="container mw-100">
    <div class="card">
        <div class="card-header">{{>header}}</div>
        <div class="card-body">
            <div class="row">
                <div class="col-12 col-lg-9 col-md-8 order-2 order-lg-1 order-md-1">
                    <div id="rezept" class="card">
                        {{>rezept_create}}
                    </div>
                </div>

                <div class="col order-sm-1 order-xs-1" >
                    <div id="userdata" class="card">
                        {{#_SESSION.renderLogin}}
                            {{>acc_login}} {{! Formular "Anmelden" anzeigen }}
                        {{/_SESSION.renderLogin}}
                        {{#_SESSION.renderVerify}}
                            {{>acc_notverified}} {{! Benutzer ist noch nicht verifiziert }}
                        {{/_SESSION.renderVerify}}
                        {{#_SESSION.renderUserinfo}}
                            {{>acc_userinfo}} {{! "Benutzerinformationen" anzeigen }}
                        {{/_SESSION.renderUserinfo}}
                        {{#_SESSION.renderRegister}}
                            {{>acc_register}} {{! Formular "Registrierung" anzeigen }}
                        {{/_SESSION.renderRegister}}
                        {{#_SESSION.renderPasswortVergessen}}
                            {{>acc_pwforgotten}} {{! Formular "Passwort vergessen" anzeigen }}
                        {{/_SESSION.renderPasswortVergessen}}
                        {{#_SESSION.renderThanksForRegister}}
                            {{>acc_danke}} {{! für die Registrierung bedanken}}
                        {{/_SESSION.renderThanksForRegister}}
                        {{#_SESSION.renderPasswortChange}}
                            {{>acc_pwchange}} {{! Formular "Passwort ändern" anzeigen }}
                        {{/_SESSION.renderPasswortChange}}
                    </div>
                    <div id="news" class="card">
                        <div class="card-body">
                            <h4 class="card-title">Neuigkeiten</h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-footer">
            {{>footer}}
        </div>
    </div>
</div>

<script src="/helper/md5.js"></script>
<script type="text/javascript">
        <!--

        function cookieOk() {
            let now = new Date(); // Variable für aktuelles Datum
            let lifetime = now.getTime(); // Variable für Millisekunden seit 1970 bis aktuelles Datum
            let deleteCookie = lifetime + 2592000000; // Macht den Cookie 30 Tage gültig.

            now.setTime(deleteCookie);
            let enddate = now.toUTCString();

            document.cookie = "setCookieHinweis = set; path=/; secure:false; expires=" + enddate;
            document.getElementById("cookie-popup").classList.add("hidden");
        }

        function validateLoginForm() {
            // Password hashen und nur den Hash posten
            this.md5pw1.value = md5(this.password.value);
            this.password.value = '';
            return true;
        }

        function validateRegisterForm() {
            removeErrors();
            let hasErrors = 0;
            if (this.loginname.value.length < 5) {
                hasErrors++;
                insertError("Der Anmeldename muss mindestens 5 Zeichen lang sein");
            }

            let loginnameRegex = /^[a-zA-Z0-9]+$/;
            if (!this.loginname.value.match(loginnameRegex)) {
                insertError("Der Anmeldename darf nur Buchstaben und Ziffern enthalten (keine Sonderzeichen und kein Leerzeichen)");
            }

            if (this.password.value.length < 8) {
                hasErrors++;
                insertError("Das Passwort muss mindestens 8 Zeichen lang sein");
            }
            if (this.password.value !== this.passwordRepeat.value) {
                hasErrors++;
                insertError("Die Passwörter müssen identisch sein, um Tippfehler ausschließen zu können");
            }
            if (this.email.value.length < 5) {
                hasErrors++;
                insertError("Bitte geben Sie eine gültige E-Mail Adresse ein");
            }

            let terms = document.getElementById('terms');
            if (!terms.checked) {
                hasErrors++;
                insertError("Bitte akzeptieren Sie die Nutzungsbedingungen");
            }

            if (hasErrors > 0)
                return false;

            // Password hashen und nur den Hash posten
            this.md5pw1.value = md5(this.password.value);
            this.password.value = '';

            this.md5pw2.value = md5(this.passwordRepeat.value);
            this.passwordRepeat.value = '';
            return true;
        }

        function validatePwChangeForm() {
            removeErrors();
            let hasErrors = 0;
            if (this.password.value.length < 8) {
                hasErrors++;
                insertError("Das Passwort muss mindestens 8 Zeichen lang sein");
            }
            if (this.password.value !== this.passwordRepeat.value) {
                hasErrors++;
                insertError("Die Passwörter müssen identisch sein, um Tippfehler ausschließen zu können");
            }
            if (hasErrors > 0)
                return false;

            // Password hashen und nur den Hash posten
            this.md5pwold.value = md5(this.password_old.value);
            this.password_old.value = '';

            this.md5pw1.value = md5(this.password.value);
            this.password.value = '';

            this.md5pw2.value = md5(this.passwordRepeat.value);
            this.passwordRepeat.value = '';
            return true;
        }

        function insertError($message) {
            let tag = document.createElement("p");
            //tag.className="mb-0";
            let text = document.createTextNode($message);
            tag.appendChild(text);
            let element = document.getElementById("client_errors");
            element.appendChild(tag);
            element.hidden = false;
        }

        function removeErrors() {
            let element = document.getElementById("client_errors");
            element.hidden = true;
            element.innerHTML = '';
        }
//-->
</script>
</body>
</html>